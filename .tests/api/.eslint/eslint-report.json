[{"filePath":"/workspace/.tests/api/eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/workspace/.tests/api/src/database.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'DB_PASS' is assigned a value but never used.","line":4,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":14},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"password\" to come before \"user\".","line":24,"column":5,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":24,"endColumn":13,"fix":{"range":[526,584],"text":"connected: true,\n    host: DB_HOST,\n    password,\n    user"}},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"connected\" to come before \"password\".","line":25,"column":5,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":25,"endColumn":20,"fix":{"range":[526,584],"text":"connected: true,\n    host: DB_HOST,\n    password,\n    user"}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":33,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[852,855],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[852,855],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'newHost' is defined but never used.","line":49,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":49,"endColumn":45},{"ruleId":"no-self-assign","severity":2,"message":"'connection.host' is assigned to itself.","line":51,"column":23,"nodeType":"MemberExpression","messageId":"selfAssignment","endLine":51,"endColumn":38},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'debugInfo' is assigned a value but never used.","line":60,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":18}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":2,"source":"// Vulnerability: hardcoded database credentials\nconst DB_HOST = \"production-db.internal.company.com\";\nconst DB_USER = \"root\";\nconst DB_PASS = \"P@ssw0rd!2024\";\nconst DB_PORT = 5432;\n\ninterface DbConnection {\n  host: string;\n  user: string;\n  password: string;\n  connected: boolean;\n}\n\nlet connection: DbConnection | null = null;\n\n// Vulnerability: credentials in function parameters with defaults\nexport function connectDb(\n  user: string = \"root\",\n  password: string = \"P@ssw0rd!2024\",\n): DbConnection {\n  connection = {\n    host: DB_HOST,\n    user,\n    password,\n    connected: true,\n  };\n  // Vulnerability: logging credentials\n  console.log(`Connected to ${DB_HOST} as ${user} with password ${password}`);\n  return connection;\n}\n\n// Bug: function never checks if connection is null before using it\nexport async function query(sql: string): Promise<any[]> {\n  console.log(\"Executing SQL:\", sql);\n  // Vulnerability: no input sanitization\n  return [];\n}\n\n// Code smell: useless function\nexport function disconnect(): void {\n  if (connection) {\n    connection = null;\n  } else {\n    connection = null;\n  }\n}\n\n// Bug: self-assignment\nexport function updateConnectionHost(newHost: string): void {\n  if (connection) {\n    connection.host = connection.host;\n  }\n}\n\n// Code smell: unused imports and dead store\nexport function getConnectionInfo(): string {\n  const port = DB_PORT;\n  const host = DB_HOST;\n  const info = `${host}:${port}`;\n  const debugInfo = `Debug: ${DB_USER}@${host}`;\n  return info;\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/.tests/api/src/index.ts","messages":[{"ruleId":"simple-import-sort/imports","severity":2,"message":"Run autofix to sort these imports!","line":1,"column":1,"nodeType":null,"messageId":"sort","endLine":3,"endColumn":40,"fix":{"range":[0,129],"text":"import { connectDb } from \"./database\";\nimport { processPayment } from \"./payment\";\nimport { getUserData } from \"./user-service\";"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'db' is assigned a value but never used.","line":5,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":9},{"ruleId":"nestjs-security/no-exposed-debug-endpoints","severity":1,"message":"üîí CWE-489 | Debug endpoint exposed without authentication | HIGH\n   Fix: Remove debug endpoints from production or add authentication | https://cwe.mitre.org/data/definitions/489.html","line":5,"column":22,"nodeType":"Literal","messageId":"violationDetected","endLine":5,"endColumn":29}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { getUserData } from \"./user-service\";\nimport { processPayment } from \"./payment\";\nimport { connectDb } from \"./database\";\n\nconst db = connectDb(\"admin\", \"admin123\");\n\nasync function main() {\n  const user = await getUserData(1);\n  console.log(user);\n\n  // Bug: floating point comparison\n  const price = 0.1 + 0.2;\n  if (price == 0.3) {\n    console.log(\"match\");\n  }\n\n  // Bug: always-true condition\n  const x = 5;\n  if (x >= 0 || x < 0) {\n    console.log(\"always true\");\n  }\n\n  await processPayment(user, 100);\n}\n\nmain();\n","usedDeprecatedRules":[]},{"filePath":"/workspace/.tests/api/src/payment.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'retries' is assigned a value but never used.","line":15,"column":3,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":10},{"ruleId":"prettier/prettier","severity":1,"message":"Replace `¬∑amount¬∑>¬∑1000¬∑?¬∑\"high\"¬∑:¬∑amount¬∑>¬∑100¬∑?¬∑\"medium\"¬∑:¬∑amount¬∑>¬∑10¬∑?¬∑\"low\"` with `‚èé¬∑¬∑¬∑¬∑amount¬∑>¬∑1000‚èé¬∑¬∑¬∑¬∑¬∑¬∑?¬∑\"high\"‚èé¬∑¬∑¬∑¬∑¬∑¬∑:¬∑amount¬∑>¬∑100‚èé¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑?¬∑\"medium\"‚èé¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑:¬∑amount¬∑>¬∑10‚èé¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑?¬∑\"low\"‚èé¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑¬∑`","line":25,"column":17,"nodeType":null,"messageId":"replace","endLine":25,"endColumn":88,"fix":{"range":[742,813],"text":"\n    amount > 1000\n      ? \"high\"\n      : amount > 100\n        ? \"medium\"\n        : amount > 10\n          ? \"low\"\n         "}},{"ruleId":"use-isnan","severity":2,"message":"Use the isNaN function to compare with NaN.","line":28,"column":7,"nodeType":"BinaryExpression","messageId":"comparisonWithNaN","endLine":28,"endColumn":26,"suggestions":[{"messageId":"replaceWithIsNaN","fix":{"range":[862,881],"text":"Number.isNaN(finalAmount)"},"desc":"Replace with Number.isNaN."}]},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"headers\" to come before \"method\".","line":39,"column":7,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":42,"endColumn":8,"fix":{"range":[1132,1431],"text":"body: JSON.stringify({\n        user_id: user.id,\n        amount: total,\n        currency,\n        status,\n        promo: promoCode,\n        key: API_KEY,\n      }),\n      headers: {\n        \"Authorization\": \"Bearer \" + SECRET,\n        \"Content-Type\": \"application/json\",\n      },\n      method: \"POST\""}},{"ruleId":"prettier/prettier","severity":1,"message":"Replace `\"Authorization\"` with `Authorization`","line":40,"column":9,"nodeType":null,"messageId":"replace","endLine":40,"endColumn":24,"fix":{"range":[1173,1188],"text":"Authorization"}},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"body\" to come before \"headers\".","line":43,"column":7,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":50,"endColumn":9,"fix":{"range":[1132,1431],"text":"body: JSON.stringify({\n        user_id: user.id,\n        amount: total,\n        currency,\n        status,\n        promo: promoCode,\n        key: API_KEY,\n      }),\n      headers: {\n        \"Authorization\": \"Bearer \" + SECRET,\n        \"Content-Type\": \"application/json\",\n      },\n      method: \"POST\""}},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"amount\" to come before \"user_id\".","line":45,"column":9,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":45,"endColumn":22,"fix":{"range":[1300,1421],"text":"amount: total,\n        currency,\n        key: API_KEY,\n        promo: promoCode,\n        status,\n        user_id: user.id"}},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"promo\" to come before \"status\".","line":48,"column":9,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":48,"endColumn":25,"fix":{"range":[1300,1421],"text":"amount: total,\n        currency,\n        key: API_KEY,\n        promo: promoCode,\n        status,\n        user_id: user.id"}},{"ruleId":"perfectionist/sort-objects","severity":1,"message":"Expected \"key\" to come before \"promo\".","line":49,"column":9,"nodeType":"Property","messageId":"unexpectedObjectsOrder","endLine":49,"endColumn":21,"fix":{"range":[1300,1421],"text":"amount: total,\n        currency,\n        key: API_KEY,\n        promo: promoCode,\n        status,\n        user_id: user.id"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":53,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":13},{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":53,"column":15,"nodeType":"BlockStatement","messageId":"unexpected","endLine":54,"endColumn":4,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[1490,1493],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]},{"ruleId":"prettier/prettier","severity":1,"message":"Delete `‚èé¬∑¬∑`","line":53,"column":16,"nodeType":null,"messageId":"delete","endLine":54,"endColumn":3,"fix":{"range":[1490,1493],"text":""}}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":8,"source":"import { User } from \"./user-service\";\n\n// Vulnerability: hardcoded credentials\nconst API_KEY = \"sk_live_abc123def456ghi789\";\nconst SECRET = \"super-secret-payment-key-2024\";\n\n// Code smell: too many parameters\nexport async function processPayment(\n  user: User,\n  amount: number,\n  currency: string = \"USD\",\n  taxRate: number = 0.1,\n  discount: number = 0,\n  promoCode: string = \"\",\n  retries: number = 3,\n): Promise<{ success: boolean; transactionId: string }> {\n  // Bug: possible division by zero\n  const finalAmount = amount / discount;\n\n  // Vulnerability: logging sensitive data\n  console.log(\"Processing payment with API_KEY:\", API_KEY);\n  console.log(\"User password:\", user.password);\n\n  // Code smell: nested ternary\n  const status = amount > 1000 ? \"high\" : amount > 100 ? \"medium\" : amount > 10 ? \"low\" : \"micro\";\n\n  // Bug: comparison with NaN\n  if (finalAmount === NaN) {\n    return { success: false, transactionId: \"\" };\n  }\n\n  const tax = finalAmount * taxRate;\n  const total = finalAmount + tax;\n\n  // Code smell: empty catch block\n  try {\n    const response = await fetch(\"https://api.payments.com/charge\", {\n      method: \"POST\",\n      headers: {\n        \"Authorization\": \"Bearer \" + SECRET,\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({\n        user_id: user.id,\n        amount: total,\n        currency,\n        status,\n        promo: promoCode,\n        key: API_KEY,\n      }),\n    });\n    return await response.json();\n  } catch (e) {\n  }\n\n  return { success: false, transactionId: \"\" };\n}\n\n// Bug: infinite loop possibility\nexport function retryPayment(userId: number): void {\n  let success = false;\n  while (!success) {\n    console.log(\"Retrying payment for user\", userId);\n    // missing: success = tryPayment();\n  }\n}\n\n// Code smell: identical branches\nexport function getDiscount(tier: string): number {\n  if (tier === \"gold\") {\n    return 0.2;\n  } else if (tier === \"silver\") {\n    return 0.1;\n  } else if (tier === \"bronze\") {\n    return 0.1;\n  }\n  return 0;\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/.tests/api/src/user-service.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[217,220],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[217,220],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"nestjs-security/no-exposed-debug-endpoints","severity":1,"message":"üîí CWE-489 | Debug endpoint exposed without authentication | HIGH\n   Fix: Remove debug endpoints from production or add authentication | https://cwe.mitre.org/data/definitions/489.html","line":27,"column":21,"nodeType":"Literal","messageId":"violationDetected","endLine":27,"endColumn":28},{"ruleId":"no-useless-assignment","severity":2,"message":"This assigned value is not used in subsequent statements.","line":35,"column":7,"nodeType":"Identifier","messageId":"unnecessaryAssignment","endLine":35,"endColumn":13},{"ruleId":"nestjs-security/no-exposed-debug-endpoints","severity":1,"message":"üîí CWE-489 | Debug endpoint exposed without authentication | HIGH\n   Fix: Remove debug endpoints from production or add authentication | https://cwe.mitre.org/data/definitions/489.html","line":36,"column":21,"nodeType":"Literal","messageId":"violationDetected","endLine":36,"endColumn":28},{"ruleId":"nestjs-security/no-exposed-debug-endpoints","severity":1,"message":"üîí CWE-489 | Debug endpoint exposed without authentication | HIGH\n   Fix: Remove debug endpoints from production or add authentication | https://cwe.mitre.org/data/definitions/489.html","line":84,"column":21,"nodeType":"Literal","messageId":"violationDetected","endLine":84,"endColumn":28},{"ruleId":"no-useless-assignment","severity":2,"message":"This assigned value is not used in subsequent statements.","line":98,"column":9,"nodeType":"Identifier","messageId":"unnecessaryAssignment","endLine":98,"endColumn":18},{"ruleId":"no-unreachable","severity":2,"message":"Unreachable code.","line":102,"column":3,"nodeType":"ExpressionStatement","messageId":"unreachableCode","endLine":102,"endColumn":54}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { query } from \"./database\";\n\nexport interface User {\n  id: number;\n  name: string;\n  email: string;\n  password: string;\n  role: string;\n}\n\n// Vulnerability: SQL injection\nexport async function getUserData(id: any): Promise<User> {\n  const sql = \"SELECT * FROM users WHERE id = \" + id;\n  const rows = await query(sql);\n  return rows[0] as User;\n}\n\n// Vulnerability: SQL injection via string concatenation\nexport async function findUserByName(name: string): Promise<User[]> {\n  const sql = \"SELECT * FROM users WHERE name = '\" + name + \"'\";\n  const rows = await query(sql);\n  return rows as User[];\n}\n\n// Bug: function always returns the same value\nexport function isAdmin(user: User): boolean {\n  if (user.role === \"admin\") {\n    return true;\n  }\n  return true;\n}\n\n// Code smell: overly complex function (cognitive complexity)\nexport function classifyUser(user: User): string {\n  let result = \"\";\n  if (user.role === \"admin\") {\n    if (user.email.includes(\"@company.com\")) {\n      if (user.name.length > 5) {\n        result = \"senior-admin\";\n      } else {\n        result = \"junior-admin\";\n      }\n    } else {\n      if (user.name.length > 5) {\n        result = \"external-admin\";\n      } else {\n        result = \"temp-admin\";\n      }\n    }\n  } else if (user.role === \"editor\") {\n    if (user.email.includes(\"@company.com\")) {\n      if (user.name.length > 5) {\n        result = \"senior-editor\";\n      } else {\n        result = \"junior-editor\";\n      }\n    } else {\n      if (user.name.length > 5) {\n        result = \"external-editor\";\n      } else {\n        result = \"temp-editor\";\n      }\n    }\n  } else {\n    if (user.email.includes(\"@company.com\")) {\n      if (user.name.length > 5) {\n        result = \"internal-user\";\n      } else {\n        result = \"new-user\";\n      }\n    } else {\n      if (user.name.length > 5) {\n        result = \"external-user\";\n      } else {\n        result = \"guest\";\n      }\n    }\n  }\n  return result;\n}\n\n// Code smell: duplicate string literals\nexport function getUserLabel(user: User): string {\n  if (user.role === \"admin\") {\n    return \"Administrator - \" + user.name;\n  }\n  if (user.role === \"editor\") {\n    return \"Editor - \" + user.name;\n  }\n  if (user.role === \"viewer\") {\n    return \"Viewer - \" + user.name;\n  }\n  return \"Unknown - \" + user.name;\n}\n\n// Bug: unused variable + dead code\nexport function processUser(user: User): void {\n  const timestamp = Date.now();\n  const label = getUserLabel(user);\n  console.log(label);\n  return;\n  console.log(\"This code is unreachable\", timestamp);\n}\n","usedDeprecatedRules":[]},{"filePath":"/workspace/.tests/api/src/utils.ts","messages":[{"ruleId":"prettier/prettier","severity":1,"message":"Replace `value:¬∑string¬∑|¬∑null,¬∑fallback:¬∑string` with `‚èé¬∑¬∑value:¬∑string¬∑|¬∑null,‚èé¬∑¬∑fallback:¬∑string,‚èé`","line":11,"column":35,"nodeType":null,"messageId":"replace","endLine":11,"endColumn":73,"fix":{"range":[277,315],"text":"\n  value: string | null,\n  fallback: string,\n"}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"// Code smell: duplicate logic\nexport function formatCurrency(amount: number): string {\n  return \"$\" + amount.toFixed(2);\n}\n\nexport function formatPrice(price: number): string {\n  return \"$\" + price.toFixed(2);\n}\n\n// Bug: incorrect null check\nexport function getValueOrDefault(value: string | null, fallback: string): string {\n  if (value !== null || value !== undefined) {\n    return value!;\n  }\n  return fallback;\n}\n\n// Vulnerability: eval usage\nexport function calculate(expression: string): number {\n  return eval(expression);\n}\n\n// Code smell: unnecessary boolean comparison\nexport function isActive(flag: boolean): boolean {\n  if (flag === true) {\n    return true;\n  } else if (flag === false) {\n    return false;\n  }\n  return false;\n}\n\n// Bug: off-by-one error in loop\nexport function getLastItems<T>(arr: T[], count: number): T[] {\n  const result: T[] = [];\n  for (let i = arr.length; i > arr.length - count; i--) {\n    result.push(arr[i]);\n  }\n  return result;\n}\n\n// Code smell: excessively long function with magic numbers\nexport function scoreUser(\n  posts: number,\n  comments: number,\n  likes: number,\n  shares: number,\n  followers: number,\n  daysActive: number,\n): number {\n  let score = 0;\n  score += posts * 10;\n  score += comments * 5;\n  score += likes * 2;\n  score += shares * 15;\n  score += followers * 3;\n  if (daysActive > 365) {\n    score *= 1.5;\n  } else if (daysActive > 180) {\n    score *= 1.25;\n  } else if (daysActive > 90) {\n    score *= 1.1;\n  } else if (daysActive > 30) {\n    score *= 1.05;\n  }\n  if (score > 10000) {\n    return 10000;\n  }\n  return Math.round(score);\n}\n","usedDeprecatedRules":[]}]